<!DOCTYPE html>
<html>
  <head>
    <title>Joke submission form</title>
    <style>
      .input{
        padding:5px;
        margin:5px;
      }
      .label{
        display: inline-block;
        width: 200px;
      }
      body{
        font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif
      }
    </style>
  </head>
  <body>
    <form action="/api/joke-submission" method="POST">
      <div >
        <label class="label" for="headline">What is the joke headline?</label>
        <input class="input" name="headline" id="headline" value="Type a funny joke" />
      </div>
      <div>
        <label class="label" for="punchline">What is the joke punchline?</label>
        <input class="input" name="punchline" id="punchline" value="Type a funny punchline" />
      </div>
      <button>Add joke</button>
    </form>
    <script>
        async function postData(url = "", data = {}) {
        const response = await fetch(url, {
          method: "POST",
          mode: "cors",
          cache: "no-cache",
          credentials: 'same-origin',
          headers: {
            'Content-Type': 'application/json'
          },
          redirect: 'follow',
          referrerPolicy: 'no-referrer',
          body: JSON.stringify(data)
        });
        return response.json();
      }

      function handleSubmit(event) {
        event.preventDefault();
        const data = new FormData(event.target);
        const joke = Object.fromEntries(data.entries());
        postData('/api/joke-submission',joke);  
        console.log(JSON.stringify(joke, null, 2));
      }

      const form = document.querySelector("form");
      form.addEventListener("submit", handleSubmit);
    </script>
  </body>
</html>
